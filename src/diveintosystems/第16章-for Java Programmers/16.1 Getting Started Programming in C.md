## 16.1. C 语言编程入门

Let’s start by looking at a "hello world" program that includes an example of calling a function from the math library. In [Table 1](https://diveintosystems.org/book/Appendix1/getting_started.html#TabJavaC) we compare the C version of this program to the Java version. The C version might be put in a file named `hello.c` (`.c` is the suffix convention for C source code files), whereas the Java version might be in a file named `HelloWorld.java`.

我们先来看一个“hello world”程序，其中包含一个从数学库调用函数的示例。在 [表 1](https://diveintosystems.org/book/Appendix1/getting_started.html#TabJavaC) 中，我们将该程序的 C 版本与 Java 版本进行了比较。C 版本可能放在名为 `hello.c` 的文件中（`.c` 是 C 源代码文件的后缀约定），而 Java 版本可能放在名为 `HelloWorld.java` 的文件中。

Table 1. Syntax Comparison of a Small Program in Java and C. Both the [C version](https://diveintosystems.org/book/Appendix1/_attachments/hello.c) and [Java version](https://diveintosystems.org/book/Appendix1/_attachments/HelloWorld.java) are available for download.
表 1. Java 和 C 中小程序的语法比较。[C 版本](https://diveintosystems.org/book/Appendix1/_attachments/hello.c) 和 [Java 版本](https://diveintosystems.org/book/Appendix1/_attachments/HelloWorld.java) 均可下载。

| Java version ([HelloWorld.java](https://diveintosystems.org/book/Appendix1/_attachments/HelloWorld.java))                                                                                                                                                                                                                                                                                                       | C version ([hello.c](https://diveintosystems.org/book/Appendix1/_attachments/hello.c))                                                                                                                                                                                                                                                                        |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <pre><code>/*<br>    The Hello World Program in Java<br> */<br><br>/* Java Math library */<br>import java.lang.Math;<br><br>/* define a HelloWorld class */<br>class HelloWorld {<br><br>  /* main method definition: */<br>  public static void main(String[] args){<br><br>   System.out.println("Hello World");<br>   System.out.println("sqrt(4) is "<br>         + Math.sqrt(4));<br>  }<br>}</code></pre> | <pre><code>/*<br>    The Hello World Program in C<br> */<br><br>/* C math and I/O libraries */<br>\#include <math.h><br>\#include <stdio.h><br><br><br><br>/* main function definition: */<br>int main(void) {<br><br>    printf("Hello World\n");<br>    printf("sqrt(4) is %f\n", sqrt(4));<br><br>    return 0;  // main returns value 0<br>}</code></pre> |


Notice that both versions of this program have similar structure and language constructs, albeit with different language syntax.
请注意，尽管语言语法不同，但该程序的两个版本都具有相似的结构和语言结构。

A few syntactic similarities include:

**Comments:**

- Multi-line comments in Java and C begin with `/*` and end with `*/`, and single-line comments begin with `//`.

**Statements:**

- Statements in C and Java end in `;`.

**Blocks:**

- Both Java and C use `{` and `}` around blocks of related code (for example, function bodies and loop bodies). Good programming style includes indenting statements inside a block.

一些句法相似之处包括：

**注释:**
- Java 和 C 中的多行注释以 `/*` 开头，以 `*/` 结尾，单行注释以 `//` 开头。

**语句:**
- C 和 Java 中的语句以“;”结尾。

**代码块:**
- Java 和 C 均使用 `{` 和 `}` 括住相关代码块（例如，函数体和循环体）。良好的编程风格包括在块内缩进语句。

A few key differences include:

**Importing library code:**

- In Java, libraries are included (imported) using `import`.
- In C, libraries are included (imported) using `#include`. All `#include` statements appear at the top of the program, outside of function bodies.

**The main function:**

- Both Java and C define `main` functions that are the first functions executed when a program is run. In C, there is only one `main` function defined, and it is automatically called when the C program executes. In Java, the `public static void main` method of the class run on the JVM is executed.
- Java is a purely object oriented language, thus all code must be part of a class (`HelloWorld` in this example). The `main` function is defined as a `public static` method in the class `HelloWorld` (`public static void main(String[] args)`). By convention `main` is a `void` function in Java and is passed an array of command line argument strings.
- C is a purely imperative and procedural language, and thus there are no classes in C. As a result, all functions are defined outside of class definitions (there are no class definitions in C). In C, `int main(void){ }` defines the main function. The `void` means it doesn’t expect to receive a parameter. Future sections show how `main` can take parameters to receive command line arguments.
- A C program must have a function named `main`, and its return type must be `int`. The `main` function in C can optionally take a parameter that is a list of strings, one per command line argument (similar to Java), but in its simplest form, `main` has no parameters. In Chapter 2 we show `main` defined to take command line arguments.
- The C `main` function has an explicit `return` statement to return an `int` value (by convention, `main` returns `0` if the main function is successfully executed without errors).

**Output:**

- In Java, the `print` and `println` methods of `System.out` can be used to print a string. The `+` operator can be used to concatenate values together to create a more complex string (for example, `"sqrt(4) is " + Math.sqrt(4)`). `System.out` also has a `printf` method to print out a format string with arguments. Values for the placeholders in the format string follow as a comma-separated list of argument values. For example, the second call to `System.out.println` in [Table 1](https://diveintosystems.org/book/Appendix1/getting_started.html#TabJavaC) could be replaced with the equivalent call `System.out.printf("sqrt(4) is %f%n", Math.sqrt(4)`), where the value of `Math.sqrt(4)` will be printed in place of the `%f` placeholder in the format string and `%n` (or `\n`) is used to specify a newline character. Java additionally has classes that can be used to format different types of values.

- In C, the `printf` function prints a formatted string like Java’s `System.out.printf` method (for example, the value of `sqrt(4)` will be printed in place of the `%f` placeholder in the format string argument, and `\n` specifies a newline character).
    
The `printf` function is used to print both format strings and simple string values (C does not have an separate function similar to Java’s `System.out.println`). C’s `printf` function also doesn’t automatically print a newline character at the end. As a result, C programmers need to explicitly specify a newline character (`\n`) in the format string when a newline is desired in the output.
    

一些主要的区别包括：

**导入库代码：**

- 在 Java 中，使用“import”来包含（导入）库。
- 在 C 语言中，使用 `#include` 来包含（导入）库。所有 `#include` 语句都出现在程序顶部，函数体之外。

**main函数:**

-  Java 和 C 都定义了 `main` 函数，它们是程序运行时最先执行的函数。在 C 中，只定义了一个 `main` 函数，它在 C 程序执行时自动调用。在 Java 中，会执行 JVM 上运行的类的 `public static void main` 方法。
-  Java 是一种纯面向对象的语言，因此所有代码都必须是类的一部分（本例中为`HelloWorld`）。 `main` 函数在类`HelloWorld`中定义为`public static`方法（`public static void main(String[] args)`）。按照惯例， `main` 在 Java 中是一个`void`函数，并传递了一个命令行参数字符串数组。
-  C 是一种纯命令式和过程式语言，因此 C 中没有类。因此，所有函数都是在类定义之外定义的（C 中没有类定义）。在 C 中，`int main(void){ }` 定义主函数。`void` 表示它不希望接收参数。后面的部分将展示 `main` 如何接受参数来接收命令行参数。
-  C 程序必须有一个名为 `main` 的函数，并且其返回类型必须是`int`。C 中的 `main` 函数可以选择接受一个字符串列表作为参数，每个命令行参数一个字符串（类似于 Java），但在其最简单的形式中， `main` 没有参数。在第 2 章中，我们展示了定义为接受命令行参数的 `main` 。
-  C `main` 函数有一个明确的`return`语句来返回一个`int`值（按照惯例，如果主函数成功执行而没有错误，则`main`返回`0`）。

**输出:**

- 在 Java 中，`System.out` 的 `print` 和 `println` 方法可用于打印字符串。`+` 运算符可用于将值连接在一起以创建更复杂的字符串（例如，`"sqrt(4) is " + Math.sqrt(4)`）。`System.out` 还有一个 `printf` 方法，用于打印带有参数的格式字符串。格式字符串中占位符的值以逗号分隔的参数值列表形式显示。例如，[表 1](https://diveintosystems.org/book/Appendix1/getting_started.html#TabJavaC) 中对 System.out.println 的第二次调用可以替换为等效调用 `System.out.printf("sqrt(4) is %f%n", Math.sqrt(4)`), 其中 `Math.sqrt(4)`的值将代替格式字符串中的 `%f` 占位符进行打印，而 `%n`(或 `\n`)用于指定换行符。Java 还具有可用于格式化不同类型值的类。
-  在 C 语言中，`printf` 函数像 Java 的 `System.out.printf` 方法一样打印格式化的字符串（例如，`sqrt(4)` 的值将打印在格式字符串参数中的 `%f` 占位符的位置，而 `\n` 指定换行符）。

`printf` 函数用于打印格式字符串和简单字符串值（C 没有类似于 Java 的 `System.out.println` 的单独函数）。C 的 `printf` 函数也不会自动在末尾打印换行符。因此，当需要在输出中使用换行符时，C 程序员需要在格式字符串中明确指定换行符（`\n`）。

### [](https://diveintosystems.org/book/Appendix1/getting_started.html#_compiling_and_running_c_programs)16.1.1. Compiling and Running C Programs编译和运行 C 程序

Java programs run on the Java virtual machine (JVM). The JVM is a program that runs directly on the underlying computer system. To run a Java program, it is first compiled (translated) by the Java compiler (`javac`) from its source code (`HelloWorld.java`) form into Java bytecode form. For example (`$` is the Linux shell prompt):
Java 程序在 Java 虚拟机 (JVM) 上运行。JVM 是直接在底层计算机系统上运行的程序。要运行 Java 程序，首先需要 Java 编译器 (`javac`) 将其源代码 (`HelloWorld.java`) 形式编译 (翻译) 为 Java 字节码形式。例如 (`$` 是 Linux shell 提示符)：

```
$ javac HelloWorld.java
```

If successful, `javac` creates a new file, `HelloWorld.class`, that contains the Java bytecode translation of the program that the JVM can run. For example:
如果成功，`javac` 将创建一个新文件 `HelloWorld.class`，其中包含 JVM 可以运行的程序的 Java 字节码转换。例如：

```
$ java HelloWorld
```

The JVM is a program that is in a form that can be run directly on the underlying system (this form is called **binary executable**) and takes as input the Java class that it runs ([Figure 1](https://diveintosystems.org/book/Appendix1/getting_started.html#FigJavaExecution)). Java bytecode is very portable in the sense that it can run on any computer system with a JVM. However, because Java bytecode does not run directly on the underlying computer system, a Java program may not run as efficiently as programs that run directly on the underlying system.

JVM 是一种可以直接在底层系统上运行的程序（这种形式称为 **二进制可执行文件**），并以它运行的 Java 类作为输入（[图 1](https://diveintosystems.org/book/Appendix1/getting_started.html#FigJavaExecution)）。Java 字节码的可移植性很高，它可以在任何具有 JVM 的计算机系统上运行。但是，由于 Java 字节码不直接在底层计算机系统上运行，因此 Java 程序的运行效率可能不如直接在底层系统上运行的程序。

![Execution of a Java program by the JVM.](https://diveintosystems.org/book/Appendix1/_images/javac.png)

Figure 1. A Java program is compiled to Java bytecode that is executed by the JVM, which is a binary executable program that is run on the underlying system (OS and hardware)
图 1. Java 程序被编译为 Java 字节码，由 JVM 执行，JVM 是在底层系统（操作系统和硬件）上运行的二进制可执行程序

To run a C program, it must first be translated into a form that a computer system can directly execute. The C **compiler**, similar to the Java compiler, is a program that translates C source code into a **binary executable** form that the computer system can directly execute. A binary executable consists of a series of 0’s and 1’s in a well-defined format that a computer can run; unlike Java bytecode that requires the JVM to run, the binary executable runs directly on the underlying system.
要运行 C 程序，必须先将其转换成计算机系统可以直接执行的形式。C **编译器**与 Java 编译器类似，是一个将 C 源代码转换成计算机系统可以直接执行的**二进制可执行文件**形式的程序。二进制可执行文件由一系列计算机可以运行的明确定义的格式的 0 和 1 组成；与需要 JVM 才能运行的 Java 字节码不同，二进制可执行文件直接在底层系统上运行。

For example, to run the C program `hello.c` on a Unix system, the C code must first be compiled by a C compiler (for example, the [GNU C compiler](https://gcc.gnu.org/), GCC) that produces a binary executable (by default named `a.out`). The binary executable version of the program can then be run directly on the system ([Figure 2](https://diveintosystems.org/book/Appendix1/getting_started.html#FigCCompile)):

例如，要在 Unix 系统上运行 C 程序“hello.c”，必须先由 C 编译器（例如 [GNU C 编译器](https://gcc.gnu.org/)、GCC）编译 C 代码，生成二进制可执行文件（默认名为“a.out”）。然后可以直接在系统上运行该程序的二进制可执行版本（[图 2](https://diveintosystems.org/book/Appendix1/getting_started.html#FigCCompile)）：

```
$ gcc hello.c
$ ./a.out
```

(Note that some C compilers might need to be explicitly told to link in the math library: `-lm`):
（请注意，某些 C 编译器可能需要明确告知链接数学库：`-lm`）：

```
$ gcc hello.c -lm
```

![C program text goes to the C compiler, which converts it into an executable sequence of zeroes and ones.  The format of the executable sequence can be run by the underlying system.](https://diveintosystems.org/book/Appendix1/_images/compile.png)

Figure 2. The C compiler (gcc) builds C source code into a binary executable file (a.out). The underlying system (OS and hardware) directly executes the a.out file to run the program.
图 2. C 编译器 (gcc) 将 C 源代码编译为二进制可执行文件 (a.out)。底层系统（操作系统和硬件）直接执行 a.out 文件来运行程序。
#### [](https://diveintosystems.org/book/Appendix1/getting_started.html#_detailed_steps)Detailed Steps详细步骤

In general, the following sequence describes the necessary steps for editing, compiling, and running a C program on a Unix system:

1. Using a [text editor](https://www.cs.swarthmore.edu/help/editors.html) (for example, `vim`), write and save your C source code program in a file (e.g., `hello.c`):
    
    $ vim hello.c
    
2. Compile the source to an executable form, and then run it. The most basic syntax for compiling with `gcc` is:
    
    $ gcc <input_source_file>
    

一般来说，以下序列描述了在 Unix 系统上编辑、编译和运行 C 程序的必要步骤：

1. 使用 [文本编辑器](https://www.cs.swarthmore.edu/help/editors.html) （例如 `vim`）编写 C 源代码程序并将其保存在文件中（例如 `hello.c`）：

```
	$ vim hello.c
```

2. 将源代码编译为可执行文件，然后运行它。使用 `gcc` 进行编译的最基本语法是：

```
	$ gcc <input_source_file>
```


If compilation yields no errors, the compiler creates a binary executable file named `a.out`. The compiler also allows you to specify the name of the binary executable file to generate using the `-o` flag:
如果编译没有错误，编译器将创建一个名为`a.out`的二进制可执行文件。编译器还允许您使用 `-o`标志指定要生成的二进制可执行文件的名称：

```
$ gcc -o <output_executable_file> <input_source_file>
```

For example, this command instructs `gcc` to compile `hello.c` into an executable file named `hello`:
例如，此命令指示`gcc`将`hello.c`编译为名为`hello`的可执行文件：

```
$ gcc -o hello hello.c
```

We can invoke the executable program using `./hello`:
我们可以使用 `./hello` 调用可执行程序：

```
$ ./hello
```

Any changes made to the C source code (the `hello.c` file) must be recompiled with `gcc` to produce a new version of `hello`. If the compiler detects any errors during compilation, the `./hello` file won’t be created/re-created (but beware, an older version of the file from a previous successful compilation might still exist).

对 C 源代码（`hello.c` 文件）所做的任何更改都必须使用 `gcc` 重新编译，以生成新版本的 `hello`。如果编译器在编译过程中检测到任何错误，则不会创建/重新创建 `./hello` 文件（但请注意，上次成功编译的文件的旧版本可能仍然存在）。

Often when compiling with `gcc`, you want to include several command line options. For example, these options enable more compiler warnings and build a binary executable with extra debugging information:

通常在使用 `gcc` 进行编译时，您需要包含几个命令行选项。例如，这些选项可启用更多编译器警告并使用额外的调试信息构建二进制可执行文件：

```
$ gcc -Wall -g -o hello hello.c
```

Because the `gcc` command line can be long, frequently the `make` utility is used to simplify compiling C programs and for cleaning up files created by `gcc`. [Using make and writing Makefiles](https://www.cs.swarthmore.edu/~newhall/unixhelp/howto_makefiles.html) are important skills that you will develop as you build up experience with C programming.

由于 `gcc` 命令行可能很长，因此经常使用 `make` 实用程序来简化 C 程序的编译以及清理由 `gcc` 创建的文件。[使用 make 和编写 Makefile](https://www.cs.swarthmore.edu/~newhall/unixhelp/howto_makefiles.html) 是您在积累 C 编程经验时将培养的重要技能。

We cover compiling and linking with C library code in more detail at the end of [Chapter 2](https://diveintosystems.org/book/C2-C_depth/advanced_libraries.html#_compilation_steps_).
我们将在[第 2 章](https://diveintosystems.org/book/C2-C_depth/advanced_libraries.html#_compilation_steps_) 末尾更详细地介绍如何使用 C 库代码进行编译和链接。
### [](https://diveintosystems.org/book/Appendix1/getting_started.html#_variables_and_c_numeric_types)16.1.2. Variables and C Numeric Types变量和 C 数字类型

Like Java, C uses variables as named storage locations for holding data. Thinking about the **scope** and **type** of program variables is important to understand the semantics of what your program will do when you run it. A variable’s **scope** defines when the variable has meaning (that is, where and when in your program it can be used) and its lifetime (that is, it could persist for the entire run of a program or only during a function activation). A variable’s **type** defines the range of values that it can represent and how those values will be interpreted when performing operations on its data.

与 Java 一样，C 使用变量作为保存数据的命名存储位置。考虑程序变量的**作用域**和**类型**对于理解程序运行时的语义非常重要。变量的**作用域**定义了变量何时具有意义（即在程序中的何时何地可以使用它）及其生命周期（即它可以在整个程序运行期间或仅在函数激活期间存在）。变量的**类型**定义了它可以表示的值的范围以及在对其数据执行操作时如何解释这些值。

In both Java and C, all variables must be declared before they can be used. To declare a variable in C, use the following syntax:
在 Java 和 C 中，所有变量都必须先声明才能使用。要在 C 中声明变量，请使用以下语法：

```
type_name variable_name;
```

A variable can have only a single **type**. The basic C types include `char`, `int`, `float`, and `double`. By convention, C variables should be declared at the beginning of their scope (at the top of a `{ }` block), before any C statements in that scope.

一个变量只能有一个**类型**。基本 C 类型包括 `char`、`int`、`float` 和 `double`。按照惯例，C 变量应在其范围的开头（`{ }` 块的顶部）声明，并且应在该范围内的任何 C 语句之前声明。

Below is an example C code snippet that shows declarations and uses of variables of some different types. We discuss types and operators in more detail after the example.
下面是一个示例 C 代码片段，展示了一些不同类型的变量的声明和使用。我们将在示例之后更详细地讨论类型和运算符。

varsin.c
```c
{
    /* 1. Define variables in this block's scope at the top of the block. */

    int x; // declares x to be an int type variable and allocates space for it

    int i, j, k;  // can define multiple variables of the same type like this

    char letter;  // a char stores a single-byte integer value
                  // it is often used to store a single ASCII character
                  // value (the ASCII numeric encoding of a character)
                  // a char in C is a different type than a string in C

    float winpct; // winpct is declared to be a float type
    double pi;    // the double type is more precise than float

    /* 2. After defining all variables, you can use them in C statements. */

    x = 7;        // x stores 7 (initialize variables before using their value)
    k = x + 2;    // use x's value in an expression

    letter = 'A';        // a single quote is used for single character value
    letter = letter + 1; // letter stores 'B' (ASCII value one more than 'A')

    pi = 3.1415926;

    winpct = 11 / 2.0; // winpct gets 5.5, winpct is a float type
    j = 11 / 2;        // j gets 5: int division truncates after the decimal
    x = k % 2;         // % is C's mod operator, so x gets 9 mod 2 (1)
}
```

### [](https://diveintosystems.org/book/Appendix1/getting_started.html#_c_types)16.1.3. C Types C类型

Unlike Java, C does not have an extensive set of class libraries defining complex data types. Instead, C supports a small set of built-in data types, and it provides a few ways in which programmers can construct basic collections of types (arrays and structs). From these basic building blocks, a C programmer can build complex data structures.

与 Java 不同，C 没有定义复杂数据类型的大量类库。相反，C 支持一小组内置数据类型，并且它提供了几种方法供程序员构建基本类型集合（数组和结构）。通过这些基本构建块，C 程序员可以构建复杂的数据结构。

C defines a set of basic types for storing numeric values. Here are some examples of numeric literal values of different C types:
C 定义了一组用于存储数值的基本类型。以下是不同 C 类型的数字文字值的一些示例：

```c
8     // the int value 8
3.4   // the double value 3.4
'h'   // the char value 'h' (its value is 104, the ASCII value of h)
```

The C `char` type stores a numeric value. However, it’s often used by programmers to store the value of an ASCII character. A character literal value is specified in C as a single character between single quotes.

C `char` 类型存储数值。但是，程序员经常使用它来存储 ASCII 字符的值。在 C 中，字符文字值指定为单引号之间的单个字符。

C doesn’t support a string type, but programmers can create strings from the `char` type and C’s support for constructing arrays of values, which we discuss in later sections. C does, however, support a way of expressing string literal values in programs: a string literal is any sequence of characters between double quotes. C programmers often pass string literals as the format string argument to `printf`:

C 不支持字符串类型，但程序员可以从 `char` 类型创建字符串，并且 C 支持构造值数组，我们将在后面的章节中讨论。但是，C 支持在程序中表达字符串文字值的方式：字符串文字是双引号之间的任何字符序列。C 程序员经常将字符串文字作为格式字符串参数传递给 `printf`：

```c
printf("this is a C string\n");
```

Java and C both support string and char type values. Typically, Java char values are 16-bit unicode values and C’s are 8-bit ascii values.

Java 和 C 都支持字符串和字符类型值。通常，Java char 值是 16 位 unicode 值，而 C 是 8 位 ascii 值。

In both Java and C a string and a `char` are two very different types, and they evaluate differently. This difference is illustrated by contrasting a C string literal that contains one character with a C `char` literal. For example:

在 Java 和 C 中，字符串和 `char` 是两种非常不同的类型，它们的求值方式也不同。通过对比包含一个字符的 C 字符串文字和 C `char` 文字可以说明这种差异。例如：

```c
'h'  // this is a char literal value   (its value is 104, the ASCII value of h)
"h"  // this is a string literal value (its value is NOT 104, it is not a char)
```

We discuss C strings and `char` variables in more detail in the [Strings](https://diveintosystems.org/book/C2-C_depth/strings.html#_strings_and_the_string_library) section later in this chapter. Here, we’ll mainly focus on C’s numeric types.
我们将在本章后面的 [字符串](https://diveintosystems.org/book/C2-C_depth/strings.html#_strings_and_the_string_library) 部分更详细地讨论 C 字符串和 `char` 变量。在这里，我们主要关注 C 的数字类型。
#### [](https://diveintosystems.org/book/Appendix1/getting_started.html#_c_numeric_types)C Numeric Types C 数字类型

C supports several different types for storing numeric values. The types differ in the format of the numeric values they represent. For example, the `float` and `double` types can represent real values, `int` represents signed integer values, and `unsigned int` represents unsigned integer values. Real values are positive or negative values with a decimal point, such as `-1.23` or `0.0056`. Signed integers store positive, negative, or zero integer values, such as `-333`, `0`, or `3456`. Unsigned integers store strictly nonnegative integer values, such as `0` or `1234`.

C 支持几种不同的类型来存储数值。这些类型在它们所表示的数值的格式上有所不同。例如，`float` 和 `double` 类型可以表示实数，`int` 表示有符号整数值，而 `unsigned int` 表示无符号整数值。实数是带有小数点的正值或负值，例如 `-1.23` 或 `0.0056`。有符号整数存储正、负或零整数值，例如 `-333`、`0` 或 `3456`。无符号整数存储严格非负的整数值，例如 `0` 或 `1234`。

C’s numeric types also differ in the range and precision of the values they can represent. The range or precision of a value depends on the number of bytes associated with its type. Types with more bytes can represent a larger range of values (for integer types), or higher-precision values (for real types), than types with fewer bytes.

C 的数字类型在它们可以表示的值的范围和精度方面也有所不同。值的范围或精度取决于与其类型关联的字节数。与字节数较少的类型相比，字节数较多的类型可以表示更大范围的值（对于整数类型）或更高精度的值（对于实数类型）。

[Table 2](https://diveintosystems.org/book/Appendix1/getting_started.html#TabNumericCTypes) shows the number of storage bytes, the kind of numeric values stored, and how to declare a variable for a variety of common C numeric types (note that these are typical sizes — the exact number of bytes depends on the hardware architecture).
[表 2](https://diveintosystems.org/book/Appendix1/getting_started.html#TabNumericCTypes) 显示了存储字节数、存储的数值类型以及如何为各种常见的 C 数字类型声明变量（请注意，这些是典型大小 - 具体字节数取决于硬件架构）。

Table 2. C Numeric Types
表 2. C 数值类型

|Type name|Usual size|Values stored|How to declare|
|---|---|---|---|
|`char`|1 byte|integers|`char x;`|
|`short`|2 bytes|signed integers|`short x;`|
|`int`|4 bytes|signed integers|`int x;`|
|`long`|4 or 8 bytes|signed integers|`long x;`|
|`long long`|8 bytes|signed integers|`long long x;`|
|`float`|4 bytes|signed real numbers|`float x;`|
|`double`|8 bytes|signed real numbers|`double x;`|

C also provides _unsigned_ versions of the integer numeric types (`char`, `short`, `int`, `long`, and `long long`). To declare a variable as unsigned, add the keyword `unsigned` before the type name. For example:
C 还提供整数数字类型的无符号版本（`char`、`short`、`int`、`long` 和 `long long`）。要将变量声明为无符号，请在类型名称前添加关键字`unsigned`。例如：

```c
int x;           // x is a signed int variable
unsigned int y;  // y is an unsigned int variable
```

The C standard doesn’t specify whether the `char` type is signed or unsigned. As a result, some implementations might implement `char` as signed integer values and others as unsigned. It’s good programming practice to explicitly declare `unsigned char` if you want to use the unsigned version of a `char` variable.

C 标准未指定 `char` 类型是有符号的还是无符号的。因此，某些实现可能将 `char` 实现为有符号整数值，而其他实现则实现为无符号整数值。如果要使用 `char` 变量的无符号版本，则明确声明 `unsigned char` 是一种良好的编程习惯。

The exact number of bytes for each of the C types might vary from one architecture to the next. The sizes in [Table 2](https://diveintosystems.org/book/Appendix1/getting_started.html#TabNumericCTypes) are minimum (and common) sizes for each type. You can print the exact size on a given machine using C’s `sizeof` operator, which takes the name of a type as an argument and evaluates to the number of bytes used to store that type. For example:

每种 C 类型的确切字节数可能因架构而异。[表 2](https://diveintosystems.org/book/Appendix1/getting_started.html#TabNumericCTypes) 中的大小是每种类型的最小（和常见）大小。您可以使用 C 的 `sizeof` 运算符打印给定机器上的确切大小，该运算符以类型的名称作为参数并计算用于存储该类型的字节数。例如：

```c
printf("number of bytes in an int: %lu\n", sizeof(int));
printf("number of bytes in a short: %lu\n", sizeof(short));
```

The `sizeof` operator evaluates to an unsigned long value, so in the call to `printf`, use the placeholder `%lu` to print its value. On most architectures the output of these statements will be:

`sizeof` 运算符的计算结果为无符号长整型值，因此在调用 `printf` 时，使用占位符 `%lu` 来打印其值。在大多数体系结构中，这些语句的输出将是：

```
number of bytes in an int: 4
number of bytes in a short: 2
```

#### [](https://diveintosystems.org/book/Appendix1/getting_started.html#_arithmetic_operators)Arithmetic Operators 算术运算符

Arithmetic operators combine values of numeric types. The resulting type of the operation is based on the types of the operands. For example, if two `int` values are combined with an arithmetic operator, the resulting type is also an integer.

算术运算符用于组合数字类型的值。运算的结果类型取决于操作数的类型。例如，如果两个 `int` 值与算术运算符组合，则结果类型也是整数。

C performs automatic type conversion when an operator combines operands of two different types. For example, if an `int` operand is combined with a `float` operand, the integer operand is first converted to its floating-point equivalent before the operator is applied, and the type of the operation’s result is `float`.

当运算符组合两种不同类型的操作数时，C 会执行自动类型转换。例如，如果 `int` 操作数与 `float` 操作数组合，则在应用运算符之前，整数操作数会先转换为其浮点数，并且运算结果的类型为 `float`。

The following arithmetic operators can be used on most numeric type operands:

- add (`+`) and subtract (`-`)
- multiply (`*`), divide (`/`), and mod (`%`):
    
    The mod operator (`%`) can only take integer-type operands (`int`, `unsigned int`, `short`, and so on).
    
    If both operands are `int` types, the divide operator (`/`) performs integer division (the resulting value is an `int`, truncating anything beyond the decimal point from the division operation). For example `8/3` evaluates to `2`.
    
    If one or both of the operands are `float` (or `double`), `/` performs real division and evaluates to a `float` (or `double`) result. For example, `8 / 3.0` evaluates to approximately `2.666667`.
    
- assignment (`=`):
    
    variable = value of expression;  // e.g., x = 3 + 4;
    
- assignment with update (`+=`, `-=`, `*=`, `/=`, and `%=`):
    
    variable op= expression;  // e.g., x += 3; is shorthand for x = x + 3;
    

- increment (`++`) and decrement (`--`):
    
    variable++;  // e.g., x++; assigns to x the value of x + 1
    

以下算术运算符可用于大多数数字类型操作数：

- 加法 (`+`) 和减法 (`-`)
- 乘法（`*`）、除法（`/`）和模数（`%`）：

	模运算符（`％`）只能采用整数类型的操作数（`int`、`unsigned int`、`short`等等）。

	如果两个操作数都是`int`类型，则除法运算符（`/`）执行整数除法（结果值为`int`，除法运算会截断小数点后的所有内容）。例如，`8/3`的计算结果为`2`。

	如果一个或两个操作数都是“浮点数”（或“双精度数”），则`/`执行实数除法并计算结果为“浮点数”（或“双精度数”）。例如，`8 / 3.0`的计算结果约为`2.666667`。

- 赋值（`=`）：

	变量 = 表达式的值；//例如，x = 3 + 4；

- 带更新的赋值（`+=`、`-=`、`*=`、`/=` 和 `%=`）：

	变量 op= 表达式；//例如，x += 3；是 x = x + 3 的简写；

- 增量（`++`）和减量（`--`）：

	变量++; // 例如，x++; 将 x + 1 的值赋给 x

|     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| --- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|     | Pre- vs. Post-increment<br><br>The operators `++variable` and `variable++` are both valid, but they’re evaluated slightly differently:<br><br>- `++x`: increment `x` first, then use its value.<br>    <br>- `x++`: use `x’s value first, then increment it.<br>    <br><br>In many cases, it doesn’t matter which you use because the value of the incremented or decremented variable isn’t being used in the statement. For example, these two statements are equivalent (although the first is the most commonly used syntax for this statement):<br><br>```c<br>x++;<br>++x;<br>```<br><br>In some cases, the context affects the outcome (when the value of the incremented or decremented variable _is_ being used in the statement). For example:<br><br>```c<br>x = 6;<br>y = ++x + 2;  // y is assigned 9: increment x first, then evaluate x + 2 (9)<br><br>x = 6;<br>y = x++ + 2;  // y is assigned 8: evaluate x + 2 first (8), then increment x<br>```<br><br>Code like the preceding example that uses an arithmetic expression with an increment operator is often hard to read, and it’s easy to get wrong. As a result, it’s generally best to avoid writing code like this; instead, write separate statements for exactly the order you want. For example, if you want to first increment `x` and then assign `x + 1` to `y`, just write it as two separate statements.<br><br>Instead of writing this:<br><br>```c<br>y = ++x + 1;<br>```<br><br>write it as two separate statements:<br><br>```c<br>x++;<br>y = x + 1;<br>``` |



> [!warning] Pre- vs. Post-increment
> The operators `++variable` and `variable++` are both valid, but they’re evaluated slightly differently:
> 
> - `++x`: increment `x` first, then use its value.
> - `x++`: use `x’s value first, then increment it.
>   
>   In many cases, it doesn’t matter which you use because the value of the incremented or decremented variable isn’t being used in the statement. For example, these two statements are equivalent (although the first is the most commonly used syntax for this statement):
>   
>   ```c
>   x++;
>   ++x;
>   ```
>   
>   In some cases, the context affects the outcome (when the value of the incremented or decremented variable _is_ being used in the statement). For example:
>   ```c
>   x = 6;
>   y = ++x + 2; // y is assigned 9: increment x first, then evaluate x + 2 (9)
>   
>   x = 6;
>   y = x++ + 2; // y is assigned 8: evaluate x + 2 first (8), then increment x
>   ```
>   
>   Code like the preceding example that uses an arithmetic expression with an increment operator is often hard to read, and it’s easy to get wrong. As a result, it’s generally best to avoid writing code like this; instead, write separate statements for exactly the order you want. For example, if you want to first increment `x` and then assign `x + 1` to `y`, just write it as two separate statements.
>   
>   Instead of writing this:
>   ```
>   y = ++x + 1;
>   ```
>   write it as two separate statements:
>   ```
>   x++;
>   y = x + 1;
>   ```



> [!warning] Pre- vs. Post-increment
> 运算符 `++variable` 和 `variable++` 都是有效的，但它们的评估方式略有不同：
> 
> - `++x`：先增加 `x`，然后使用它的值。
> - `x++`：首先使用 `x` 的值，然后增加它。
>   
>   在许多情况下，使用哪种语句并不重要，因为语句中未使用递增或递减变量的值。例如，这两个语句是等效的（尽管第一个语句是此语句最常用的语法）：
>   
>   ```c
>   x++;
>   ++x;
>   ```
>   
>   在某些情况下，上下文会影响结果（当语句中使用递增或递减变量的值时）。例如：
>   ```c
>   x = 6;
>   y = ++x + 2; // y is assigned 9: increment x first, then evaluate x + 2 (9)
>   
>   x = 6;
>   y = x++ + 2; // y is assigned 8: evaluate x + 2 first (8), then increment x
>   ```
>   
>   像上例这样使用带有增量运算符的算术表达式的代码通常难以阅读，而且很容易出错。因此，最好避免编写这样的代码；相反，按照您想要的顺序编写单独的语句。例如，如果您想先增加`x`，然后将`x + 1`赋值给`y`，只需将其写成两个单独的语句即可。
>   
>  而不要这样写：
>   ```
>   y = ++x + 1;
>   ```
>   将其写成两个单独的语句：
>   ```
>   x++;
>   y = x + 1;
>   ```
